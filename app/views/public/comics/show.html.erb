<div class="container mt-3">
  <div class="row">
    <div class="col-md-2">
      <%= render 'public/customers/customer', customer: @comic.customer %>
    </div>

    <div class="col">
      <h3 class="text-center">投稿詳細</h3>

        <div class="text-right">
          <% if customer_signed_in? && current_customer.email != 'guest@guest'%>
              <% if @comic.bookmarked_by?(current_customer) %>
                  <%= link_to public_comic_bookmark_path(@comic), method: :delete, class:"btn btn-info btn-sm" do %>
                    <i class="fas fa-bookmark"></i>
                    ブックマークを外す(<%= @comic.bookmarks.count %>)
                  <% end %>
              <% else %>
                  <%= link_to public_comic_bookmark_path(@comic), method: :post, class:"btn btn-secondary btn-sm" do %>
                    <i class="fas fa-bookmark"></i>
                    ブックマークする(<%= @comic.bookmarks.count %>)
                  <% end %>
             <% end %>
          <% end %>
        </div>

        <table class="table table-bordered">
          <tr>
            <td>タイトル</td>
            <td><%= @comic.title %></td>
          </tr>

          <tr>
            <td>著者名</td>
            <td><%= @comic.name %></td>
          </tr>

          <tr>
            <td>出版社</td>
            <td><%= @comic.company %></td>
          </tr>

          <tr>
            <td>発行年月日</td>
            <td><%= @comic.release_date.strftime("%Y年%m月%d日") %></td>
          </tr>

          <!--星レビュー機能-->
          <tr>
            <td>おすすめ度</td>
            <td>
              <div id="star-rate-<%= @comic.id %>">

                  <script>
                    $('#star-rate-<%= @comic.id %>').empty();
                    $('#star-rate-<%= @comic.id %>').raty({
                    size      : 36,
                    starOff   : '<%= asset_path('star-off.png') %>',
                    starOn    : '<%= asset_path('star-on.png') %>',
                    starHalf  : '<%= asset_path('star-half.png') %>',
                    half      : true,
                    readOnly: true,
                    score: <%= @comic.star %>,
                    });
                  </script>

              </div>
            </td>
          </tr>

          <tr>
            <td>ジャンル</td>
            <td>
              <% @comic_genres.each do |genre| %>
                <%= link_to public_genre_comics_genre_path(genre_id: genre.id) do %>
                  <%= genre.genre_name %>
                <% end %>
              <% end %>
            </td>
          </tr>

          <tr>
            <td>タグ</td>
            <td>
              <% @comic_tags.each do |tag| %>
                <%= link_to public_tag_comics_tag_path(tag_id: tag.id) do %>
                  <%= tag.tag_name %>
                <% end %>
              <% end %>
            </td>
          </tr>

          <tr>
            <td>投稿日時</td>
            <td><%= @comic.created_at.strftime("%Y年%m月%d日") %></td>
          </tr>

          <tr>
            <td>本文</td>
            <td><%= @comic.body %></td>
          </tr>
        </table>
      </div>
    </div>
      <div class="row text-right">
          <div class="col">
            <%= link_to public_comic_comic_comments_path(@comic), class:"btn btn-primary btn-sm" do %>
              コメント一覧(<%= @comic.comic_comments.count %>)
            <% end %>
          </div>

            <% if @comic.customer == current_customer %>

              <div class="col">
                  <%= link_to "内容を編集する", edit_public_comic_path(@comic), class:"btn btn-success btn-sm" %>
              </div>

              <div class="col">
                  <%= button_to "この投稿を削除する", public_comic_path(@comic), method: :delete, class:"btn btn-danger btn-sm" %>
              </div>

            <% end %>

        </div>
        <div class="row mt-3 text-right">
          <div class="col">
            <% if customer_signed_in? && current_customer.email != 'guest@guest' %>

              <%= form_with model: [@comic, @comic_comment], url: public_comic_comic_comments_path(@comic), method: :post do |f| %>
                <%= f.text_area :comment, size:"80x3" %>
                <%= f.submit "コメントを送信する", class:"btn btn-warning btn-sm" %>
              <% end %>

            <% end %>
          </div>
        </div>

</div>